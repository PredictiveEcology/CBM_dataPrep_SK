---
title: "CBM_dataPrep_SK"
author:
  - Celine Boisvenue
  - Camille Giuliano
date: "March 2025"
output:
  html_document:
    keep_md: yes
editor_options:
  chunk_output_type: console
  markdown: 
    wrap: sentence
---
```{r setup-CBM_dataPrep, include = FALSE}
```
# CBM_dataPrep_SK

:::{.rmdimportant}
This documentation is work in progress. Potential discrepancies and omissions may exist for the time being. If you find any, please contact us [here](https://github.com/PredictiveEcology/CBM_datPrep_SK/issues).
:::

## Overview

[CBM_dataPrep_SK](https://github.com/PredictiveEcology/CBM_dataPrep_SK.git) processes study area-specific spatially explicit inputs for use in [CBM_vol2biomass](https://github.com/PredictiveEcology/CBM_vol2biomass.git) and [CBM_core](https://github.com/PredictiveEcology/CBM_core.git). [SpaDES](https://SpaDES.PredictiveEcology.org) was designed for spatially explicit modelling and provides a wide variety of tools to support it. [CBM_dataPrep_SK](https://github.com/PredictiveEcology/CBM_dataPrep_SK.git) makes use of these tools. This module's inputs are study area and scenario specific making [CBM_dataPrep_SK](https://github.com/PredictiveEcology/CBM_dataPrep_SK.git) the most idiosyncratic module of the [spadesCBM](https://github.com/PredictiveEcology/spadesCBM.git) [deck](https://predictiveecology.github.io/spadesCBM/lexicon.html), meaning that this is the module that will require users to adapt their available information for their study area. We use an example that simulates a scenario where remotely-sensed disturbances are simulated in the managed forests of Saskatchewan from 1985 to 2011, as described in @boisvenue2016 (scenario = time horizon + disturbances). We suggest that users wanting to run [spadesCBM](https://github.com/PredictiveEcology/spadesCBM.git) for their study-area modify this module, adapting their inputs to produce the outputs of [CBM_dataPrep_SK](https://github.com/PredictiveEcology/CBM_dataPrep_SK.git). The module would then become **CBM_dataPrep_NewStudyArea**.

## Inputs

| Name | Class | Description | Source |
|-----------------|-----------------|---------------------|-----------------|
| masterRaster | SpatRaster | Raster of study area | User provided, for SK: [Google Drive](https://drive.google.com/file/d/1zUyFH8k6Ef4c_GiWMInKbwAl6m6gvLJW) |
| ageLocator | SpatRaster | Spatial data source of stand age | [2012 CASFRI inventory](https://drive.google.com/file/d/1ip4VGdKjPhQjElxJjHkM_1BoVM2C_sXs) | 
| ageDataYear | Numeric | Year that the ages in ageLocator represent | [2012 CASFRI inventory](https://drive.google.com/file/d/1ip4VGdKjPhQjElxJjHkM_1BoVM2C_sXs) |
| ageSpinupMin | Numeric | Minimum age for cohorts during spinup | Default is set to 3 |
| gcIndexLocator | SpatRaster | Raster giving the growth curve value for each pixel | [Google Drive](https://drive.google.com/file/d/1yunkaYCV2LIdqej45C4F9ir5j1An0KKr) |
| userGcMeta | Data table | Growth curve metadata | User provided, for SK: [Google Drive](https://drive.google.com/file/d/1ugECJVNkglSSQFVqnk5ayG6q38l6AWe9) |
| userGcM3 | Data table | User provided growth curve data | [Google Drive](https://drive.google.com/file/d/1u7o2BzPZ2Bo7hNcC8nEctNpDmp7ce84m) |
| disturbanceMeta | Data table |  Table defining the disturbance event types | [Google Drive](https://drive.google.com/file/d/12z25mHl7McRm1ee7V7dgtSHdLP8-QEZp) |

## Module functioning

[CBM_dataPrep_SK](https://github.com/PredictiveEcology/CBM_dataPrep_SK.git) has a single event used to read in user-provided information or provide study area specific defaults. By default, it sets the administrative boundary name, reads in and prepares default disturbance rasters for SK (Wulder and white), sets the study area by creating `masterRaster`, and reads in any study area specific rasters. 

## Outputs

| Name | Class | Description |
|------|-------|-------------|
| masterRaster | SpatRaster | Raster of study area |
| adminLocator | Character | Spatial data source of Canada's administrative boundary names |
| curveID | Character |
| disturbanceRasters | list | Disturbance rasters for each simulation year |
| disturbanceMeta | Data table | Disturbance rasters metadata |

## Links to other modules

- [CBM_defaults](https://github.com/PredictiveEcology/CBM_defaults)
- [CBM_dataPrep](https://github.com/PredictiveEcology/CBM_dataPrep)
- [CBM_vol2biomass](https://github.com/PredictiveEcology/CBM_vol2biomass)
- [CBM_core](https://github.com/PredictiveEcology/CBM_core)
